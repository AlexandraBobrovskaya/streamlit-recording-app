import streamlit as st
from datetime import date, time, timedelta
import calendar  # –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏–π –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏

st.set_page_config(page_title="–°–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏", layout="wide")

# --- –í–µ—Ä—Ö–Ω–µ–µ –º–µ–Ω—é (—Å–∞–π–¥–±–∞—Ä) ---
main_menu = st.sidebar.radio(
    "–ù–∞–≤–∏–≥–∞—Ü–∏—è:",
    ["–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ", "–ú–æ–∏ –∑–∞–ø–∏—Å–∏", "–õ–∏—Å—Ç –æ–∂–∏–¥–∞–Ω–∏—è", "–û–∂–∏–¥–∞–Ω–∏–µ"]
)

# --- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ ---
if main_menu == "–ú–æ–∏ –∑–∞–ø–∏—Å–∏":
    st.title("üìå –ú–æ–∏ –∑–∞–ø–∏—Å–∏")
    st.write("–ó–¥–µ—Å—å –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.")

elif main_menu == "–õ–∏—Å—Ç –æ–∂–∏–¥–∞–Ω–∏—è":
    st.title("üìã –õ–∏—Å—Ç –æ–∂–∏–¥–∞–Ω–∏—è")
    st.write("–°–ø–∏—Å–æ–∫ –ª—é–¥–µ–π, –æ–∂–∏–¥–∞—é—â–∏—Ö –∑–∞–ø–∏—Å—å.")

elif main_menu == "–û–∂–∏–¥–∞–Ω–∏–µ":
    st.title("‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ")
    st.write("–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –æ–∂–∏–¥–∞–Ω–∏–∏.")

elif main_menu == "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ":
    st.title("‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ")

    admin_tab = st.radio(
        "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:",
        ["–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è", "–£—Å–ª—É–≥–∏", "–ó–∞–ø–∏—Å–∏", "–õ–∏—Å—Ç –æ–∂–∏–¥–∞–Ω–∏—è"],
        horizontal=True
    )

    # ---------------- –í–∫–ª–∞–¥–∫–∞ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è ----------------
    if admin_tab == "–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è":
        st.subheader("üéâ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º–∏")

        if st.button("‚ûï –°–æ–∑–¥–∞—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ"):
            st.info("–§–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å (–º–∞–∫–µ—Ç).")

        event_name = st.text_input("–ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è")

        # --- –°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤ —Å –≥–∞–ª–æ—á–∫–∞–º–∏ ---
        st.markdown("**–ì–æ—Ä–æ–¥–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è:**")
        city_options = ["–õ–∏–ø–µ—Ü–∫", "–ó–∞—Ä–∏–Ω—Å–∫", "–ú–æ—Å–∫–≤–∞"]
        selected_cities = st.multiselect("–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥–∞", city_options)

        # –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π –≥–æ—Ä–æ–¥
        custom_city = st.text_input("–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π –≥–æ—Ä–æ–¥")
        if custom_city:
            selected_cities.append(custom_city)

        st.write(f"–í—ã–±—Ä–∞–Ω—ã –≥–æ—Ä–æ–¥–∞: {', '.join(selected_cities) if selected_cities else '–ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤'}")

        st.subheader("üìÖ –î–∞—Ç—ã –∏ –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è")
        start_date = st.date_input("–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è", date.today())
        end_date = st.date_input("–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è", date.today())
        start_time = st.time_input("–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞", time(9, 0))
        end_time = st.time_input("–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è", time(18, 0))

        description = st.text_area("–û–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è")

        if st.button("üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ"):
            st.success("–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ (–º–∞–∫–µ—Ç).")

    # ---------------- –í–∫–ª–∞–¥–∫–∞ –£—Å–ª—É–≥–∏ ----------------
    elif admin_tab == "–£—Å–ª—É–≥–∏":
        st.subheader("üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏")

        if st.button("‚ûï –°–æ–∑–¥–∞—Ç—å —É—Å–ª—É–≥—É"):
            st.info("–§–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É—Å–ª—É–≥–∏ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å (–º–∞–∫–µ—Ç).")

        st.markdown("### –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å–ª—É–≥–µ")
        service_name = st.text_input("–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏")
        event_name = st.selectbox("–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ", ["–ó–¥–æ—Ä–æ–≤—ã–π –≤—ã–±–æ—Ä", "–°–µ–º–µ–π–Ω—ã–µ –≤—ã—Å–æ—Ç—ã", "–ß—Ç–æ-—Ç–æ –µ—â–µ"])
        city = st.selectbox("–ì–æ—Ä–æ–¥", ["–õ–∏–ø–µ—Ü–∫", "–ú–æ—Å–∫–≤–∞", "–ó–∞—Ä–∏–Ω—Å–∫", "+–î—Ä—É–≥–æ–π"])
        if city == "+–î—Ä—É–≥–æ–π":
            city = st.text_input("–í–≤–µ–¥–∏—Ç–µ —Å–≤–æ–π –≥–æ—Ä–æ–¥")
        address = st.text_input("–ê–¥—Ä–µ—Å")
        description = st.text_area("–û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏")

        st.subheader("üìÖ –î–∞—Ç—ã –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è")
        start_date = st.date_input("–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è", date.today())
        end_date = st.date_input("–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è", date.today())

        # ---------------- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª–æ—Ç–æ–≤ ----------------
        st.subheader("‚è± –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª–æ—Ç–æ–≤")
        slot_mode = st.radio("–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª–æ—Ç–æ–≤:", ["–û–¥–∏–Ω–∞–∫–æ–≤–æ –¥–ª—è –≤—Å–µ—Ö –¥–Ω–µ–π", "–û—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è"])
        delta = (end_date - start_date).days + 1

        if slot_mode == "–û–¥–∏–Ω–∞–∫–æ–≤–æ –¥–ª—è –≤—Å–µ—Ö –¥–Ω–µ–π":
            st.markdown("**–û–±—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–ª–æ—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –¥–Ω–µ–π**")
            start_time = st.time_input("–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Å–ª–æ—Ç–æ–≤", time(9, 0))
            end_time = st.time_input("–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å–ª–æ—Ç–æ–≤", time(18, 0))
            slot_duration = st.number_input("–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª–æ—Ç–∞ (–º–∏–Ω)", 15, 180, 60)
            slot_capacity = st.number_input("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ–ª–æ–≤–µ–∫ –≤ —Å–ª–æ—Ç–µ", 1, 100, 22)
            break_duration = st.number_input("–ü–µ—Ä–µ—Ä—ã–≤ –º–µ–∂–¥—É —Å–ª–æ—Ç–∞–º–∏ (–º–∏–Ω)", 0, 120, 30)
            lunch_break = st.checkbox("–ë–æ–ª—å—à–æ–π –æ–±–µ–¥–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ä—ã–≤")
            if lunch_break:
                lunch_start = st.time_input("–ù–∞—á–∞–ª–æ –æ–±–µ–¥–∞", time(13, 0))
                lunch_end = st.time_input("–ö–æ–Ω–µ—Ü –æ–±–µ–¥–∞", time(14, 0))

        elif slot_mode == "–û—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è":
            for i in range(delta):
                current_day = start_date + timedelta(days=i)
                weekday_name = calendar.day_name[current_day.weekday()]
                st.markdown(f"**–î–µ–Ω—å {i+1} ‚Äî {current_day.strftime('%d.%m.%Y')}, {weekday_name}**")
                start_time = st.time_input(f"–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Å–ª–æ—Ç–æ–≤ - {current_day}", time(9, 0), key=f"start_{i}")
                end_time = st.time_input(f"–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å–ª–æ—Ç–æ–≤ - {current_day}", time(18, 0), key=f"end_{i}")
                slot_duration = st.number_input(f"–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª–æ—Ç–∞ (–º–∏–Ω) - {current_day}", 15, 180, 60, key=f"duration_{i}")
                slot_capacity = st.number_input(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ–ª–æ–≤–µ–∫ –≤ —Å–ª–æ—Ç–µ - {current_day}", 1, 100, 22, key=f"capacity_{i}")
                break_duration = st.number_input(f"–ü–µ—Ä–µ—Ä—ã–≤ –º–µ–∂–¥—É —Å–ª–æ—Ç–∞–º–∏ (–º–∏–Ω) - {current_day}", 0, 120, 30, key=f"break_{i}")
                lunch_break = st.checkbox(f"–ë–æ–ª—å—à–æ–π –æ–±–µ–¥–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ä—ã–≤ - {current_day}", key=f"lunch_check_{i}")
                if lunch_break:
                    lunch_start = st.time_input(f"–ù–∞—á–∞–ª–æ –æ–±–µ–¥–∞ - {current_day}", time(13, 0), key=f"lunch_start_{i}")
                    lunch_end = st.time_input(f"–ö–æ–Ω–µ—Ü –æ–±–µ–¥–∞ - {current_day}", time(14, 0), key=f"lunch_end_{i}")

        if st.button("üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —É—Å–ª—É–≥—É"):
            st.success("–£—Å–ª—É–≥–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ (–º–∞–∫–µ—Ç).")

    # ---------------- –í–∫–ª–∞–¥–∫–∞ –ó–∞–ø–∏—Å–∏ ----------------
    elif admin_tab == "–ó–∞–ø–∏—Å–∏":
        st.subheader("üìë –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏")
        st.write("–ó–¥–µ—Å—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏.")

    # ---------------- –í–∫–ª–∞–¥–∫–∞ –õ–∏—Å—Ç –æ–∂–∏–¥–∞–Ω–∏—è ----------------
    elif admin_tab == "–õ–∏—Å—Ç –æ–∂–∏–¥–∞–Ω–∏—è":
        st.subheader("üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏—Å—Ç–æ–º –æ–∂–∏–¥–∞–Ω–∏—è")
        st.write("–ó–¥–µ—Å—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ—á–µ—Ä–µ–¥—å—é.")


